<!DOCTYPE html>
<html>
<head>
  <title>Annual Leave Usage</title>
  <meta charset='utf-8' />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <style type="text/css">
    * {
      box-sizing: border-box;
    }

    html, body {
      height: 100%;
      padding: 0;
      margin: 0;
    }

    body {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /*.status {*/
      /*text-align: center;*/
    /*}*/

    .loading {
      position: relative;
      padding-left: 5px;
    }

    @keyframes spinner {
      to {transform: rotate(360deg);}
    }

    .loading:before {
      content: '';
      box-sizing: border-box;
      position: absolute;
      top: 50%;
      left: 0;
      width: 20px;
      height: 20px;
      margin-top: -10px;
      margin-left: -20px;
      border-radius: 50%;
      border: 2px solid #ccc;
      border-top-color: #333;
      animation: spinner .6s linear infinite;
    }
  </style>
</head>
<body>

<div class="modal show" tabindex="-1" role="dialog" id="modal">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">
          Annual Leave
          <button id="signout-button" class="pull-right btn btn-xs btn-default" style="display: none;">Sign Out</button>
        </h3>
      </div>
      <div class="modal-body">
        <div id="app">
          <div class="row">
            <div class="col-sm-12">
              <div class="progress">
                <div class="progress-bar progress-bar-striped" :class="progressBarColour" role="progressbar" :aria-valuenow="leavePercent"
                     aria-valuemin="0" aria-valuemax="100" v-bind:style="{ width: leavePercent + '%' }">
                  <span>{{ leaveRemaining }} days</span>
                </div>
              </div>
            </div>
            <div class="col-sm-3">
              <dl>
                <dt>Leave taken</dt><dd>{{ leaveTaken }} days</dd>
                <dt>Leave remaining</dt><dd>{{ leaveRemaining }} days</dd>
                <dt>Weeks left</dt><dd>{{ weeksLeft }} weeks</dd>
                <dt>Working days left</dt><dd>{{ workingDaysLeft }} days</dd>
              </dl>
            </div>
            <div class="col-sm-9" v-if="ready">
              Holiday events created by <strong>{{ userEmail }}</strong> or mentioning <strong>{{ userName }}</strong>:
              <ol>
                <li v-for="(event, index) in holidays" :title="event.creator.email">
                  {{ event.start.dateTime || event.start.date }} ({{ holidaysUsed(event) }} days)
                  - <em>{{ event.summary }}</em>
                </li>
              </ol>
            </div>
            <div class="col-sm-9 status" v-else>
              <div class="loading" v-if="status">
                {{ status }}
              </div>
              <div id="authorize-button-container" style="display: none;">
                <p>
                  Sign-in with your Google credentials to see your holidays.
                </p>
                <button id="authorize-button" class="btn btn-primary">Authenticate</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script src="//cdn.jsdelivr.net/npm/vue"></script>
<script src="js/script.js"></script>
<script async defer src="https://apis.google.com/js/api.js" onload="this.onload=function(){};handleClientLoad()" onreadystatechange="if (this.readyState === 'complete') this.onload()"></script>
</body>
</html>
