<!DOCTYPE html>
<html>
<head>
  <title>Annual Leave Usage</title>
  <meta charset="UTF-8">
  <meta name="author" content="Finn Bacall">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

<div class="app-wrapper">
  <div v-cloak class="app-container" id="app">
    <div class="app-header">
      <h3>
        Annual Leave <small>{{ startYear }} - {{ endYear }}</small>
        <button class="pull-right btn btn-xs btn-default" v-if="ready && signedIn" @click="signOut">Sign Out</button>
      </h3>
    </div>
    <div class="app-body">
      <div class="row">
        <div class="col-sm-12">
          <div class="progress">
            <div class="progress-bar progress-bar-striped" :class="progressBarColour" role="progressbar" :aria-valuenow="leavePercent"
                 aria-valuemin="0" aria-valuemax="100" v-bind:style="{ width: leavePercent + '%' }">
              <span>{{ leaveRemaining }} days</span>
            </div>
          </div>
        </div>
        <div class="col-sm-3">
          <dl>
            <template v-if="extraDays">
              <dt>Days carried over</dt><dd>{{ extraDays }} days</dd>
            </template>
            <dt>Leave taken</dt><dd>{{ leaveTaken }} days</dd>
            <dt>Leave remaining</dt><dd>{{ leaveRemaining }} days</dd>
            <dt>Weeks left</dt><dd>{{ weeksLeft }} weeks</dd>
            <dt>Working days left</dt><dd>{{ workingDaysLeft }} days</dd>
          </dl>
        </div>
        <div class="col-sm-9">
          <div v-if="ready">
            <div v-if="signedIn">
              Holiday events created by <strong>{{ userEmail }}</strong> or mentioning <strong>{{ userName }}</strong>:
              <ol>
                <li v-for="(event, index) in holidays" :title="event.creator.email">
                  {{ event.start.dateTime || event.start.date }} ({{ holidaysUsed(event) }} days)
                  - <em>{{ event.summary }}</em>
                </li>
              </ol>
            </div>
            <div id="authorize-button-container" v-else>
              <p>Sign-in with your Google credentials to see your holidays.</p>
              <button class="btn btn-primary" @click="signIn">Authenticate</button>
            </div>
          </div>
          <div class="loading status" v-else>
            {{ status }}
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script src="//cdn.jsdelivr.net/npm/vue"></script>
<script src="js/script.js"></script>
<script async defer src="https://apis.google.com/js/api.js" onload="this.onload=function(){};handleClientLoad()" onreadystatechange="if (this.readyState === 'complete') this.onload()"></script>
</body>
</html>
